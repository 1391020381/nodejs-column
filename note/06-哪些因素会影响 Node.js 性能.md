# 代码逻辑
1. CPU密集型计算
* CPU负责了程序的运行和业务逻辑的处理,而CPU密集型表示的主要是`CPU承载了比较复杂的运算`
* 在Node.js中由于主线程是单线程的,无论是主线程逻辑,还是回调处理逻辑,最终都是在主线程处理,那么如果该线程一直在处理复杂的计算,其他请求就无法再次进来,也就是单个用户就可以阻塞所有用户的请求。因此保持主线程的通畅是非常关键的。
* 在Node.js中有以下几种情况,会影响到主线程的运行,应该主动避免:
    - 大的数据循环,比如没有利用好数据流,一次性处理非常大的数组。
    - 字符串处理转化，比如加解密 字符串序列化等
    - 图片 视频的计算处理,比如对图片进行裁剪 缩放或者切割等
 * 因为某些用户的复杂请求运算,而影响到整个系统的请求处理,如果这种复杂运算占用的CPU时间越久,那么就会`导致请求堆积,而这就会进一步导致系统处于崩溃状态无法恢复`   
2. 网络I/O 
* 网络I/O中有2种相关的类型,同步阻塞I/O和异步非阻塞I/O
    - 同步阻塞I/O的字面意思是发出网络请求后需要等待返回后再处理其他计算
    - 异步非阻塞I/O就是发起网络I/O后,还可以处理其他的计算。


 * 单个异步网络请求提升性能,我们需要关注什么呢
    - 通道复用,通道复用,减少TCP握手,那么就可以提升该接口的性能,或者将某些内部服务使用UDP来实现
    - 增加缓存,对于相同响应的返回数据,增加缓存处理,避免不必要的计算
    - 长链接链接池,有一些网络I/O是长链接的形式,比如MySQL Mamcached或者Rdis,为了避免排队使用长链接,可以使用链接池,而由于Redis和Node.js是单线程非阻塞处理,因此可以不用连接池

 * 网络I/O一般不影响主线程,往往`网络I/O请求的服务反而是瓶颈端`,从而影响Node.js中涉及该网络服务的请求。其次网络I/O堆积较多会侧面影响:
    - 服务器本身的网络模块问题
    - Node.js性能 导致其他服务接口受影响
    - 因此在网络I/O瓶颈时需要考虑修改服务器网络相关配置

 * 只有`CPU密集计算会真正影响到Node.js服务性能,而网络I/O和磁盘I/O都是直接影响服务器性能,从而侧面影响大Node.js服务性能` 一般这个时候就需要调整服务器配置或者做一些队列优化方式提升服务器性能。 




 1. 多进程cluster模式 (master childprocess)
 * 这种模式的主进程也就是 master进程会存在瓶颈,`因此所有的请求都必须经过 master进程进行分发,同时接受处理worker进程的返回。` 
 * `大概在2万以上的并发时,master进程会存在性能瓶颈。`

 # 其他相关